webpackJsonp([1],{"0g0p":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTk1RjRBN0JEMzI3MTFFNzg2RTlEMUE1NEVGM0RCRUIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTk1RjRBN0FEMzI3MTFFNzg2RTlEMUE1NEVGM0RCRUIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RjNDMEMzMjU4RDgxMTFFNzk4RkRDNjU5RDdBOTc4QTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RjNDMEMzMjY4RDgxMTFFNzk4RkRDNjU5RDdBOTc4QTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7MSCn1AAAG4UlEQVR42sxbWWxUVRj+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"},"1nF6":function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("//Fk"),n=s.n(a),i=s("7+uW"),c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var o=s("VU/8")({name:"App"},c,!1,function(t){s("1nF6")},null,null).exports,r=s("/ocq"),l={data:function(){return{fromData:{pass:"",userName:"",checkPass:""}}},methods:{submitForm:function(t){var e=this,s=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.axios.post("/user/login",e.fromData).then(function(t){if(t)if(t.data.data.length>0){var e=t.data.data[0];s.$socket.emit("login",e),s.$router.push({name:"chatMain",params:{userId:e._id}})}else s.$message.error("登陆失败")})})},resetForm:function(t){this.$refs[t].resetFields()}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-layout"},[a("el-form",{ref:"fromData",staticClass:"flex-ruleForm",attrs:{model:t.fromData,"status-icon":"","label-width":"100px"}},[a("el-form-item",[a("div",{staticClass:"flex-img text-center"},[a("img",{attrs:{src:s("0g0p")}})])]),t._v(" "),a("el-form-item",{attrs:{prop:"userName"}},[a("el-input",{attrs:{type:"text",placeholder:"用户名","auto-complete":"off"},model:{value:t.fromData.userName,callback:function(e){t.$set(t.fromData,"userName",e)},expression:"fromData.userName"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"pass"}},[a("el-input",{attrs:{type:"password",placeholder:"密 码","auto-complete":"off"},model:{value:t.fromData.pass,callback:function(e){t.$set(t.fromData,"pass",e)},expression:"fromData.pass"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"checkPass"}},[a("el-input",{attrs:{type:"password",placeholder:"确认密码","auto-complete":"off"},model:{value:t.fromData.checkPass,callback:function(e){t.$set(t.fromData,"checkPass",e)},expression:"fromData.checkPass"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("fromData")}}},[t._v("提交")]),t._v(" "),a("el-button",{on:{click:function(e){t.resetForm("fromData")}}},[t._v("重置")])],1)],1)],1)},staticRenderFns:[]};var u=s("VU/8")(l,h,!1,function(t){s("htSe")},"data-v-efc109e2",null).exports,d=s("BO1k"),m=s.n(d),f={data:function(){return{leftNavName:"message",searchName:"",currentUser:{_id:this.$route.params.userId},chatUser:{},listData:[],chatContent:"",showContentParent:[],showContentChild:[]}},mounted:function(){var t=this.$route.params.userId;this.$socket.emit("connect",""),this.doSearchPersonList(t)},sockets:{connect:function(){this.id=this.$socket.id},receiveMessage:function(t){if(t._id===this.currentUser._id){this.showContentParent.push({sendId:t.sendId,receiverId:t._id,message:t.sendContent,flag:"0"}),this.showContentChild=[];var e=!0,s=!1,a=void 0;try{for(var n,i=m()(this.showContentParent);!(e=(n=i.next()).done);e=!0){var c=n.value;this.chatUser._id===c.sendId&&this.showContentChild.push(c),this.chatUser._id===c.receiverId&&this.showContentChild.push(c)}}catch(t){s=!0,a=t}finally{try{!e&&i.return&&i.return()}finally{if(s)throw a}}for(var o in this.listData)console.log(t._id,this.listData[o]._id,t._id===this.listData[o]._id),t._id===this.listData[o]._id&&(this.listData[o].tip=t.sendContent,console.log("xxx",t.sendContent));setTimeout(function(){var t=document.getElementById("chatContent");t.scrollTop=t.scrollHeight},100)}}},methods:{getUser:function(t){for(var e in this.chatUser=t,this.listData)this.listData[e].flag=!1;t.flag=!0,this.showContentChild=[];var s=!0,a=!1,n=void 0;try{for(var i,c=m()(this.showContentParent);!(s=(i=c.next()).done);s=!0){var o=i.value;t._id===o.sendId&&this.showContentChild.push(o),t._id===o.receiverId&&this.showContentChild.push(o)}}catch(t){a=!0,n=t}finally{try{!s&&c.return&&c.return()}finally{if(a)throw n}}},changeTab:function(t){this.leftNavName=t},doSearchPersonList:function(t){var e=this;this.axios.post("/userChat/findUser",{_id:t}).then(function(t){t&&(e.listData=t.data.data)})},sendMessage:function(){if(this.chatUser._id){var t=this.$refs.sendContent.innerText;this.chatUser.sendContent=t,this.chatUser.sendId=this.currentUser._id,this.showContentParent.push({sendId:this.currentUser._id,receiverId:this.chatUser._id,message:t,flag:"1"}),this.showContentChild.push({sendId:this.currentUser._id,receiverId:this.chatUser._id,message:t,flag:"1"}),setTimeout(function(){var t=document.getElementById("chatContent");t.scrollTop=t.scrollHeight},100),this.$socket.emit("sendMessage",this.chatUser),this.$refs.sendContent.innerText=""}else this.$message.info("请选择你要聊天的用户")}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-layout"},[a("div",{staticClass:"chat"},[a("div",{staticClass:"chat-left"},[a("div",{staticClass:"chat-left-nav"},[a("div",{staticClass:"chat_tab_div"},[a("ul",{staticClass:"chat-tab-ul"},[a("li",{class:["person"===t.leftNavName?"chat-tab-select":""]},[a("span",{staticClass:"icon",class:["person"===t.leftNavName?"icon-person-light":"icon-person"],on:{click:function(e){t.changeTab("person")}}})]),t._v(" "),a("li"),t._v(" "),a("li",{class:["message"===t.leftNavName?"chat-tab-select":""]},[a("span",{staticClass:"icon",class:["message"===t.leftNavName?"icon-message-light":"icon-message"],on:{click:function(e){t.changeTab("message")}}})])])]),t._v(" "),a("div",{staticClass:"chat-search"},[a("el-input",{attrs:{placeholder:"请输入内容","prefix-icon":"",size:"small"},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}},[a("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:t.doSearchPersonList},slot:"suffix"})])],1),t._v(" "),a("div",[a("ul",{staticClass:"person-ul"},t._l(t.listData,function(e){return a("li",{key:e._id,class:{"person-ul-select":e.flag},on:{click:function(s){t.getUser(e)}}},[a("el-badge",{staticClass:"person-ul-img",attrs:{value:0}},[a("img",{attrs:{src:s("0g0p"),alt:"img"}})]),t._v(" "),a("div",{staticClass:"person-ul-info"},[a("span",{staticClass:"user-name"},[t._v(t._s(e.userName))]),t._v(" "),a("span",{staticClass:"user-tip"},[t._v(t._s(e.tip))])])],1)}))])])]),t._v(" "),a("div",{staticClass:"chat-right"},[a("div",{staticClass:"chat-right-top"},[a("span",[t._v(t._s(t.chatUser.userName))])]),t._v(" "),a("div",{staticClass:"chat-right-content",attrs:{id:"chatContent"}},[a("ul",{staticClass:"chat-list-ul"},t._l(t.showContentChild,function(e){return a("li",{key:e.index,staticClass:"im-chat-cli",class:"1"===e.flag?"im-chat-clir":"im-chat-clil"},[(e.flag,a("img",{attrs:{src:s("0g0p"),alt:"img"}})),t._v(" "),a("div",[t._v(t._s(e.message))])])}))]),t._v(" "),a("div",{staticClass:"chat-right-bottom"},[a("div",{staticClass:"chat-inputArea"},[a("div",{ref:"sendContent",staticClass:"inputArea",attrs:{contenteditable:""},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.sendMessage(e):null}}})]),t._v(" "),a("div",{staticClass:"send-button"},[a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:t.sendMessage}},[t._v("发送（S）")])],1)])])])])},staticRenderFns:[]};var v=s("VU/8")(f,p,!1,function(t){s("ei5r")},"data-v-4255dbeb",null).exports;i.default.use(r.a);var C=new r.a({routes:[{path:"/",name:"login",component:u},{path:"/chatMain/:userId",name:"chatMain",component:v}]}),g=s("zL8q"),N=s.n(g),b=(s("tvR6"),s("mtWM")),I=s.n(b),x=(s("VaBq"),s("hMcO")),U=s.n(x);i.default.use(U.a,"127.0.0.1:3000"),I.a.interceptors.request.use(function(t){return t.url="http://127.0.0.1:3000"+t.url,t},function(t){return n.a.reject(t)}),i.default.use(N.a),i.default.config.productionTip=!1,i.default.prototype.axios=I.a,new i.default({el:"#app",router:C,sockets:{connect:function(){console.log("socket connected")},customEmit:function(t){console.log('this method was fired by the socket server. eg: io.emit("customEmit", data)')}},components:{App:o},template:"<App/>"})},VaBq:function(t,e){},ei5r:function(t,e){},htSe:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.4eaf9737c00f3c597076.js.map